#!/usr/bin/env python
# coding=utf-8
"""
Usage: wiva <url> [ <revision> ] [ --verbose ] [ --debug ] [ --wikitext=<wikitext_file> ]
"""
import logging

import docopt
from mediawiki import Article
from validation import Validation
from wikitext_checkers import ALL_CHECKERS

logger = logging.getLogger(__name__)
logging.basicConfig(level=logging.CRITICAL)


def cli(arguments):
    if arguments['--debug']:
        logging.root.setLevel(logging.DEBUG)

    article = Article(arguments['<url>'])
    if arguments['--wikitext']:
        with open(arguments['--wikitext'], 'r') as f:
            article._wikitext = f.read()

    validation = Validation(article, ALL_CHECKERS)
    for message in validation.messages:
        print message
    return


if __name__ == '__main__':
    arguments = docopt.docopt(__doc__)
    cli(arguments)

__author__ = 'alistra'
